spring:
  application:
    name: elliott-wave-bot

management:
  endpoints:
    web:
      exposure:
        include: health,info

bot:
  mode: BACKTEST

bybit:
  baseUrl: https://api-testnet.bybit.com
  wsPublicUrl: wss://stream-testnet.bybit.com/v5/public/spot
  wsPrivateUrl: wss://stream-testnet.bybit.com/v5/private
  apiKey: ${BYBIT_API_KEY:}
  apiSecret: ${BYBIT_API_SECRET:}
  recvWindowMs: 5000
  category: spot
  symbol: BTCUSDT
  interval: 15
  htfInterval: 60

strategy:
  zigzag:
    mode: PERCENT
    percentThreshold: 0.008
    atrPeriod: 14
    atrMultiplier: 2.0
  elliott:
    enforceWave4NoOverlap: true
    minScoreToTrade: 0.60
    swingAtrMultiplier: 2.0
    fib:
      wave2PreferredMin: 0.5
      wave2PreferredMax: 0.618
      takeProfitExtension: 2.2
  volatility:
    atrPeriod: 14
    minAtrPercent: 0.0
    maxAtrPercent: 0.05
  volume:
    period: 20
    minMultiplier: 0.8
  features:
    enableWaveFilter: true
    enableShortWave: false
    enableTrendFilter: false
    enableVolumeFilter: true
    enableRegimeGate: true
    enableSwingFallback: true
    entryModel: RELAXED
    exitModel: FIXED
  fastBreakout:
    lookbackBars: 20
    atrStopMultiplier: 1.2
    atrTakeProfitMultiplier: 2.5
    breakoutAtrBuffer: 0.0
    minBodyAtr: 0.0
  exit:
    atrStopMultiplier: 1.5
    atrTakeProfitMultiplier: 3.0
    trailActivationAtr: 0.0
    trailDistanceAtr: 0.0
    timeStopBars: 48
    maxStopAtrMultiplier: 0.0
    breakEvenAtr: 0.0
  entry:
    minRewardRisk: 1.0
  feeAware:
    enabled: true
    minEdgeMultiple: 2.0
    bufferBps: 2
  trendStrength:
    enabled: true
    model: ER
    n: 20
    threshold: 0.20
  volExpansion:
    enabled: true
    lookback: 120
    compressionQuantile: 0.40
    requireRising: true
    recentCompressionBars: 40
    period: 20
    stdDevMultiplier: 2.0
  pyramiding:
    enabled: true
    maxAdds: 4
    addOnRiskFraction: 0.9
    minBarsBetweenAdds: 4
    triggerModel: ATR_MOVE
    minMoveAtr: 0.2
  regime:
    slopeLookbackBars: 20
    weakSlope: 0.002
    strongSlope: 0.01
    minTradesPerBucket: 10
    thresholds:
      atrLow: 0.002057
      atrHigh: 0.003239
      volumeLow: 1.214275
      volumeHigh: 1.664459
    blocked: []
    allowed:
      - UP_STRONG|LOW|HIGH
      - FLAT|HIGH|HIGH
  shortGate:
    enabled: true
    requireDowntrend: true
    allowed:
      - DOWN_STRONG|MID|HIGH
      - DOWN_STRONG|HIGH|HIGH

risk:
  riskPerTrade: 0.10
  dailyMaxDd: 0.20
  maxConsecutiveLosses: 3
  cooldownMinutes: 60
  minQty: 0.0
  maxQty: 1000000.0
  maxLeverage: 15
  statePath: data/risk-state.json
  compounding:
    enabled: true
    minRiskPerTrade: 0.02
    maxRiskPerTrade: 0.30
    scaleUp: 1.30
    scaleDown: 0.85
    minMultiplier: 0.5
    maxMultiplier: 7.0

backtest:
  initialCapital: 1000
  feeRate: 0.0006
  slippageBps: 2
  maxLookbackBars: 600
  maxHtfLookbackBars: 400
  startMs:
  endMs:
  csvPath: data/sample_btcusdt_15m.csv

research:
  enabled: false
  mode: REPORT
  outputDir: build/reports
  walkForward:
    trainDays: 90
    testDays: 30
    minTrades: 8
    maxTrials: 12
    enableRegimeGate: true

portfolio:
  statePath: data/portfolio-state.json
